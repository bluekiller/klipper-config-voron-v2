[gcode_macro KILOQUBIT_TEST_PROBE_ACCURACY]
description: Run KiloQubit's Probe Accuracy Test
gcode:
    {% set verbose = params.VERBOSE|default(true) %}

    {% if verbose %}
        RESPOND MSG="Starting daemon..."
    {% endif %}
    RUN_SHELL_COMMAND CMD=start_probe_accuracy_daemon
    {% if verbose %}
        RESPOND MSG="Daemon started"
    {% endif %}

    {% if verbose %}
        RESPOND MSG="Homing..."
    {% endif %}
    _CG28

    {% if printer.quad_gantry_level.applied|lower == 'false' %}
      {% if verbose %}
        RESPOND MSG="QGL..."
      {% endif %}
      QUAD_GANTRY_LEVEL
    {% endif %}

    G28 Z

    START_FILTER SPEED=1

    TEST_PROBE_ACCURACY {% for p in params %}{'%s=%s ' % (p, params[p])}{% endfor %}

